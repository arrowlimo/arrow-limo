================================================================================
EMPLOYEE TABLE CLEANUP - EXECUTIVE SUMMARY
================================================================================

CURRENT STATE:
  Total records:        1,003 (MESSY)
  Real employees:       136   (from verified XLS)
  Garbage/Duplicates:   867   (79% noise!)
  
BREAKDOWN:
  ✓ REAL employees:         136  (verified, active)
  ✗ LEGACY_METADATA:        799  (addresses, phone fragments, PDF captions)
  ✗ QBO_IMPORT:              54  (QuickBooks duplicates)
  ✗ PLACEHOLDER:              2  (Dead Employee File, etc.)
  ? OTHER:                    12  (unclassified)

FOREIGN KEY DEPENDENCIES:
  driver_payroll:     130 employees linked
  charters:           141 employees linked (assigned drivers)
  employee_expenses:    0 employees linked

THE PROBLEM:
  • 799 LEGACY_METADATA records are pure junk (no business value)
  • 15 columns are 100% empty (never used)
  • Multiple duplicate names in different ID rows (same person, 2+ records)
  • Some LEGACY records are referenced by charters (must fix before deleting)

THE SOLUTION: 3-PHASE CLEANUP
  
  Phase 1: Fix 10 "Unsafe" LEGACY Records
    └─ These are referenced by charters
    └─ Merge real person records (e.g., Crystal Matychuk) into primary
    └─ Update charter FKs to point to primary employee ID
    └─ Delete duplicate LEGACY records
    └─ DELETE 10 records

  Phase 2: Delete 789 "Safe" LEGACY Records
    └─ No foreign key references
    └─ All are metadata fragments (addresses, phones, PDF captions)
    └─ DELETE 789 records
    └─ Result: 204 employees remain (1003 - 799)

  Phase 3: Clean QBO Duplicates & Empty Columns
    └─ Merge QBO records with payroll refs into primary REAL records
    └─ Delete QBO records without business links
    └─ Remove 15 empty columns from schema
    └─ Result: ~180 clean, consolidated employee records

DATA EXPORT (REVERSIBLE):
  ✓ JSON backup created: reports/employees_backup_before_migration.json
  └─ All 1,003 records exported before any changes
  └─ Can restore individual records if needed

SCRIPTS CREATED:
  ✓ scripts/analyze_employee_duplicates.py      - Full analysis
  ✓ scripts/check_legacy_fks.py                 - FK dependency check
  ✓ scripts/consolidate_employees_phase1.py     - Phase 1 (attempted, FK error found)
  → Need to handle 10 unsafe records first

NEXT STEPS:
  1. Create Phase 1 script: Merge 10 unsafe LEGACY into real employees
  2. Create Phase 2 script: Delete 789 safe LEGACY records
  3. Create Phase 3 script: Dedup QBO, drop empty columns
  4. Test on backup copy first
  5. Run phases 1-3 in order

EXPECTED RESULT:
  Before:  1,003 records, 58 columns, 79% garbage
  After:   ~180 records, 43 columns, 100% business-relevant
           ✓ All payroll links intact
           ✓ All charter driver assignments intact
           ✓ All duplicates merged into primary records
           ✓ No orphaned FKs
           ✓ Fully auditable via JSON backup

TIME ESTIMATE: 2-3 hours total (mostly automated)

================================================================================
KEY INSIGHT:
The employee table accumulated massive junk during QuickBooks migration.
1,000+ employee records but only 130 with actual payroll.
This cleanup removes noise without losing any business data.
================================================================================
